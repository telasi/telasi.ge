<%= render partial: 'new_customers/top' %>

<!-- files & upload button -->

<% if @application.editable_online? %>
  <div class="btn-toolbar" style="margin-bottom: 16px;"> 
    <a href="<%= new_customer_upload_file_url(id: @application.id) %>" class="btn btn-success">
      <i class="fa fa-plus-circle"></i>
      <%= t 'models.network_new_customer_application.actions.upload' %>
    </a>
  </div>
<% end %>

<% if @application.files.any? %>
<table class="table table-hover table-bordered">
  <thead>
    <tr>
      <th>#</th>
      <th>Дата, Время</th>
      <th>Имя файла</th>
      <th>Размер файла</th>
      <th class="text-center"><i class="fa fa-cog"></i></th>
    </tr>
  </thead>
  <tbody>
    <% @application.files.each_with_index do |file, index| %>
      <tr>
        <td class="text-right">
          <%= index + 1 %>
        </td>
        <td><%= file.created_at.strftime('%d/%m/%Y %H:%M:%S') %></td>
        <td>
          <a href="<%= file.file.to_s  %>">
            <%= file.file.filename %>
          </a>
        </td>
        <td class="text-right">
          <code><%= (file.file.size / 1000.0).round %></code> kB
        </td>
        <td class="text-center">
          <% if @application.editable_online? %>
            <a href="<%= new_customer_delete_file_url(id: file.id) %>" data-method="delete" class="btn btn-sm btn-default" data-confirm="<%= t 'models.network_new_customer_application.actions.delete_confirm' %>">
              <i class="fa fa-trash-o"></i>
            </a>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
<% end %>

<!-- required documents -->

<h3 class="page-header">Список необходимых документов</h3>
<% if @application.docs_are_ok? %>
  <div class="alert alert-success">
    <%= yes_no true %>
    Все необходимые документы приведены.
  </div>
<% else %>
  <div class="alert alert-danger">
    <%= yes_no false %>
    Пока не все необходимые документы приведены в заявке.
  </div>
<% end %>

<!-- project documentation -->
<% if @application.doc_project %>
  <h3 class="text-success page-header">
    Шаг #1: Загрузите проект <%= yes_no true %>
  </h3>
<% else %>
  <h3 class="text-danger page-header">
    Шаг #1: Загрузите проект <%= yes_no false %>
  </h3>
  <ol>
    <li>Необходимо иметь проект, утвержденный городской архитектурной службой;</li>
    <li>Отсканируйте проект и всю приложенную к нему документацию и поместите в один файл;</li>
    <li>Нажмите на кнопку "Добавление документа" и загрузите файл с вашего компьютера;</li>
    <li>
      После завершения заргузки проекта нажмите кнопку подтверждения:
    </li>
  </ol>
  <div class="text-center">
    <a href="<%= new_customer_confirm_step_url(id: @application.id, step: 'doc_project') %>" data-method="post" data-confirm="Подтвердите, что действительно загрузили документ проекта!" class="btn btn-success">
      <i class="fa fa-check"></i>
      Шаг #1 завершен
    </a>
  </div>
<% end %>

<!-- payment documentation -->
<% if @application.doc_payment %>
  <h3 class="text-success page-header">
    Шаг #2: Оплатите 50% стоимости <%= yes_no true %>
  </h3>
<% else %>
  <h3 class="text-danger page-header">
    Шаг #2: Оплатите 50% стоимости <%= yes_no false %>
  </h3>
  <ol>
    <li>
      Стоимость подключения к сети в вашем случае будет составлять <code><%= @application.amount %></code> GEL.
      Вы должны оплатить минимум <code>50</code>%;
    </li>
    <li>
      <%= link_to 'Напечатайте платежное поручение', new_customer_paybill_url(id: @application.id, format: 'pdf') %>
      и оплатите указанную сумму в банке;
    </li>
    <li>
      Отсканируйте выданный банком подтверждающий документ об оплате и
      сохраните на вашем компьютере;
    </li>
    <li>
      Добавьте подтверждующий документ в вашу заявку. Для этого используйте большую зеленную кнопку "Добавление документа;
    </li>
    <li>
      После завершения всех вышеуказанных шагов нажмите кнопку:
    </li>
  </ol>
  <div class="text-center">
    <a href="<%= new_customer_confirm_step_url(id: @application.id, step: 'doc_payment') %>" data-method="post" data-confirm="დაადასტურეთ, რომ ნამდვილად ატვირთეთ გადახდის დოკუმენტი!" class="btn btn-success">
      <i class="fa fa-check"></i>
      Шаг #2 завершен
    </a>
  </div>
<% end %>